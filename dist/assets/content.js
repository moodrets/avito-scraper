let d=null;const o={profileName:".desktop-1r4tu1s",profileReviewsCount:".desktop-fgq05w",profileRating:'[data-marker="profile/score"]',profileSubscribers:'[data-marker="favorite-seller-counters"]',profileDeviveryInfo:".Sidebar-root-h24MJ .ProfileBadge-root-bcR8G:nth-child(2)",reviewsItem:".style-snippet-E6g8Y",reviewsItemProductName:".desktop-35wlrd",reviewsItemDateDelivery:".desktop-11ffzh3",reviewsItemRatingStars:".RatingStars-root-Edhhx .Attributes-yellow-star-PY9XT",reviewsMoreLoadButton:'[data-marker="rating-list/moreReviewsButton"]'};async function r(e){await chrome.runtime.sendMessage(e)}async function u(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}function a(){window.scrollTo({left:0,top:document.body.scrollHeight,behavior:"smooth"})}async function m(e){const t=document.querySelector(o.profileName),s=document.querySelector(o.profileReviewsCount),n=document.querySelector(o.profileRating),i=document.querySelector(o.profileSubscribers),c=document.querySelector(o.profileDeviveryInfo),l={createdDate:Date.now(),createdDateFormatted:new Date().toLocaleString("ru-RU"),name:(t==null?void 0:t.textContent)||"Информация не найдена",rating:(n==null?void 0:n.textContent)||"Информация не найдена",reviewsCount:(s==null?void 0:s.textContent)||"Информация не найдена",subscribers:(i==null?void 0:i.textContent)||"Информация не найдена",deliveryInfo:(c==null?void 0:c.textContent)||"Информация не найдена",existsInDataBase:!1,url:e.profileLink};await r({toastType:"success",toastText:"Получена информация профиля",profileInform:l})}const p={loadMoreButton(){return document.querySelector(o.reviewsMoreLoadButton)},async parseItems(){const e=[],t=document.querySelectorAll(o.reviewsItem);if(!t.length){await r({action:"parsing-ended",toastType:"error",toastText:"Отзывы не найдены"});return}console.log(d),t.forEach(s=>{}),await r({action:"parsing-ended",toastType:"success",toastText:"Парсинг отзывов завершен",parsedReviewsList:e})},async loadMoreOnPage(){a(),await u(2e3);const e=this.loadMoreButton();if(e&&(e==null||e.click(),this.loadMoreOnPage()),!e){if(await u(2e3),this.loadMoreButton()){this.loadMoreOnPage();return}a(),this.parseItems()}},async parsingStart(){await r({action:"parsing-started",toastType:"success",toastText:"Парсинг отзывов запущен"}),a(),await u(2e3),a(),this.loadMoreOnPage()}};chrome.runtime.onMessage.addListener(async({action:e,filterFields:t})=>{if(!t){await r({toastType:"success",toastText:"Страница не получила поля фильтра"});return}e==="parsing-start"&&t&&(d=t,m(t),p.parsingStart())});
